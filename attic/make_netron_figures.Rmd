```{r, eval = FALSE}
devtools::load_all()

task = tsk("boston_housing")
lrn = lrn("regr.smlp2")
lrn$train(task)

fp = tempfile(fileext = ".h5")
lrn$save(fp)
system(paste0("netron ", fp))
```

```{r}
T_max = 10
T_mult = 2
eta_min = 1e-5
a = function(epoch, lr) {
   if (epoch == 1L) base_lr <<- lr
   if (epoch %% T_max == 0) {
     T_max <<- T_max * T_mult
   }
   eta_min + 0.5 * (base_lr - eta_min) * (1 + cos((epoch / T_max)*pi))
}

f = sapply(1:100, function(x) a(x,1))
plot(f)
```